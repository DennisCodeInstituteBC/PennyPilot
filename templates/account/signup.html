{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% load account socialaccount %}

{% block extra-css %}
<!-- <link rel="stylesheet" href="{% static 'css/signup.css' %}"> -->
{% endblock extra-css %}

{% block head_title %}{% trans "Sign Up" %}{% endblock head_title %}

{% block content %}
<div class="signup-page-container">
    <div class="signup-wrapper">
        <!-- Left Image Container -->
        <div class="signup-image">
            <img src="{% static 'images/signup-image.jpg' %}" alt="Sign up image">
        </div>

        <!-- Right Form Container -->
        <div class="signup-container">
            <h2>{% trans "Sign Up" %}</h2>

            <form method="POST" action="{% url 'account_signup' %}" id="signupForm" onsubmit="return validatePassword()">
                {% csrf_token %}
                
                <label for="fname">{% trans "First Name" %}</label>
                <input type="text" id="fname" name="first_name" required>
                
                <label for="lname">{% trans "Last Name" %}</label>
                <input type="text" id="lname" name="last_name" required>
                
                <label for="email">{% trans "Email" %}</label>
                <input type="email" id="email" name="email" required>
                
                <label for="password">{% trans "Password" %}</label>
                <input type="password" id="password" name="password" required>
                <small>{% trans "Password must be at least 8 characters long, contain letters and numbers." %}</small>
                
                <label for="repassword">{% trans "Re-enter Password" %}</label>
                <input type="password" id="repassword" name="repassword" required>
                
                <p id="passwordError" class="error" style="display:none;">{% trans "Passwords do not match" %}</p>

                <input type="submit" value="{% trans 'Sign Up' %}">
            </form>

            <div class="login-link">
                {% trans "Already have an account?" %} <a href="{% url 'account_login' %}">{% trans "Login" %}</a>
            </div>
        </div>
    </div>
</div>

<script>
    function validatePassword() {
        const password = document.getElementById("password").value;
        const repassword = document.getElementById("repassword").value;
        const errorMsg = document.getElementById("passwordError");

        errorMsg.style.display = "none";

        if (password.length < 8) {
            errorMsg.textContent = "{% trans 'Password must be at least 8 characters long.' %}";
            errorMsg.style.display = "block";
            return false;
        }

        const passwordRegex = /^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/;
        if (!password.match(passwordRegex)) {
            errorMsg.textContent = "{% trans 'Password must contain both letters and numbers.' %}";
            errorMsg.style.display = "block";
            return false;
        }

        if (password !== repassword) {
            errorMsg.textContent = "{% trans 'Passwords do not match.' %}";
            errorMsg.style.display = "block";
            return false;
        }

        return true;
    }
</script>
{% endblock content %}
